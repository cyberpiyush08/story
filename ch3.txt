this is modified version of chapter 3
